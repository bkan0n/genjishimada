# Enable OAuth2 authentication
auth_backends.1 = oauth2
auth_backends.2 = internal

# OAuth2 Configuration
auth_oauth2.resource_server_id = rabbitmq
auth_oauth2.issuer = https://portal.bkan0n.com

# JWKS endpoint for token verification
auth_oauth2.jwks_url = https://portal.bkan0n.com/.well-known/jwks.json

# Algorithm
auth_oauth2.algorithms.1 = RS256

# Username claim mapping
auth_oauth2.preferred_username_claims.1 = sub
auth_oauth2.preferred_username_claims.2 = email
auth_oauth2.preferred_username_claims.3 = preferred_username
auth_oauth2.preferred_username_claims.4 = client_id
auth_oauth2.preferred_username_claims.5 = azp

# Default permissions (NOT auth_oauth2.default_permissions)
default_permissions.configure = .*
default_permissions.read = .*
default_permissions.write = .*

# Management UI OAuth
management.oauth_enabled = true
management.oauth_client_id = $(OAUTH_CLIENT_ID)
management.oauth_client_secret = $(OAUTH_CLIENT_SECRET)
management.oauth_provider_url = https://portal.bkan0n.com

# Optional: OAuth metadata URL for auto-discovery
management.oauth_metadata_url = https://portal.bkan0n.com/.well-known/openid-configuration

# Optional: Scopes to request
management.oauth_scopes = openid profile email